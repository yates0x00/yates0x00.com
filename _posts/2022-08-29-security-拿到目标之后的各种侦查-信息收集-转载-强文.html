<p>refer to: https://www.freebuf.com/articles/web/340195.html</p>
<p>这个真的不错。</p>
<div id="tinymce-editor" class="content-detail"><div><h1>1.&#160;&#160; 简介</h1>
<p>渗透的本质是信息收集，信息收集也叫做资产收集。</p>
<p>信息收集是渗透测试的前期主要工作，是非常重要的环节，收集足够多的信息才能方便接下来的测试，信息收集主要是收集网站的域名信息、子域名信息、目标网站信息、目标网站真实IP、敏感/目录文件、开放端口和中间件信息等等。通过各种渠道和手段尽可能收集到多的关于这个站点的信息，有助于我们更多的去找到渗透点，突破口。</p>
<h1>2.&#160; &#160;粗略分类</h1>
<h1>3.&#160;&#160; 目标对象分析</h1>
<p>单个目标服务器（非web）</p>
<p>Web服务器</p>
<p>整个网络拓扑</p>
<p><strong>内网：</strong>
</p>
<p>网络设备：交换机、路由器、防火墙、ids等</p>
<p>网络中的服务器：文件服务器、dns、http、域控制器等</p>
<p><strong>外网：</strong>
</p>
<p>相关联的其他服务器（ip关联、服务关联）</p>
<p>旁站、c段、邮件服务器、dns服务器、代理服务器等</p>
<h1>4.&#160;&#160; Web方向信息收集</h1>
<h3 id="h3-1">4.1.&#160;&#160; 域名信息</h3>
<h4>4.1.1.1.&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160; 对应ip收集</h4>
<p>相关域名对应ip，相关工具：nslookup、ip138……</p>
<h4>4.1.1.2.&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160; 子域名收集</h4>
<h5>4.1.1.2.1.&#160;&#160; 子域名作用</h5>
<p>收集子域名可以扩大测试范围，统一域名下的二级域名都属于目标范围</p>
<h5>4.1.1.2.2.&#160;&#160;&#160;&#160;&#160; 常用方式</h5>
<p>查找目标域名信息的方法</p>
<blockquote><p>fofa title=“公司名称”</p>
<p>百度 intitle=公司名称</p>
<p>Google intitle=公司名称</p>
<p>站长之家直接搜索名称或者网站域名即可查看相关信息：<a href="http://tool.chinaz.com">http://tool.chinaz.com</a>
</p>
<p>钟馗之眼 site=域名即可 <a href="https://www.zoomeye.org/">https://www.zoomeye.org/﻿</a>
</p>
</blockquote>
<p>子域名在线查询</p>
<p>https：//www.t1h2ua.cn/tools/</p>
<p>工具：layer、subDomainsBrute</p>
<h4>4.1.1.3.&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160; Whois信息查询</h4>
<p>根据已知域名反查，分析出此域名的注册人、邮箱、电话等</p>
<p>工具：爱站网、站长工具、微步在线（<a>https://x.threatbook.cn）、site.ip138.com、searchdns.netcraft.com</a>、国外whois信息查询网址：https://who.is</p>
<h3 id="h3-2">4.2.&#160;&#160; 敏感目录</h3>
<p>通过扫描目录和文件，大致了解同站的的结构，获取突破点，比如后台，文件备份，上传点</p>
<h4>4.2.1.1.&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160; 收集方向</h4>
<p>Robots.txt、后台目录、安装包、上传目录、mysql管理接口、安装页面、phpinfo、编辑器、iis短文件、分析网站cms</p>
<h4>4.2.1.2.&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160; 常用工具</h4>
<p>字典爆破è御剑、dirbuster、wwwscan、iis_shortname_scanner等</p>
<p>蜘蛛爬行è爬行菜刀、webrobot、burp等</p>
<h3 id="h3-3">4.3.&#160;&#160; 端口分析</h3>
<p>服务器需要开放服务，就必须开启端口，常见的端口是tcp和udp两种类型范围0-65535通过扫描得到的端口访问服务，规划下一步渗透</p>
<h3 id="h3-4">4.4.&#160;&#160; 旁站c段</h3>
<p>旁站：一个服务器上有多个网站 通过ip查询服务器上的网站</p>
<p>C段：查找同一个ip段服务器上的网站，可以找到同样同站的类型和服务器，也可以获取同段服务器进行下一步渗透</p>
<h4>4.4.1.1.&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160; 收集方向</h4>
<p>域名、端口、目录</p>
<h4>4.4.1.2.&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160; 常用工具</h4>
<p>Webèhttp://www.5kik.com/c/、目录扫描工具</p>
<p>端口èportscan</p>
<h3 id="h3-5">4.5.&#160;&#160; 整站分析</h3>
<h4>4.5.1.1.&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160; 服务器类型</h4>
<p>服务器平台、版本等</p>
<h4>4.5.1.2.&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160; 网站容器</h4>
<p>搭建网站等服务组件，例如：iis、apache、nginx、tomact等</p>
<h4>4.5.1.3.&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160; 脚本类型</h4>
<p>Asp、php、jsp、aspx等</p>
<h4>4.5.1.4.&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160; 数据库类型</h4>
<p>Access、sqlserver、mysql、oracle、postgresql等</p>
<p>Asp+access/sqlserver</p>
<p>Aspx+sqlserver/access</p>
<p>Php+mysql</p>
<p>Php+postgresql</p>
<p>Php+oracle</p>
<p>Jsp+sqlserver/mysql/oracle</p>
<p>Linux jsp+mysql</p>
<p>Windows jsp+sqlserver</p>
<h4>4.5.1.5.&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160; CMS类型</h4>
<p>根据经验：</p>
<p><strong>Robots文件</strong>
</p>
<p>/plugs/ &#160;之梦</p>
<p><strong>登陆后台泄露cms</strong>
<strong>类型</strong>
</p>
<p><strong>网站页脚泄露的cms</strong>
</p>
<p><strong>工具自动化识别cms</strong>
<strong>类型</strong>
</p>
<p><strong>对应的cms</strong>
<strong>漏洞直接利用</strong>
</p>
<p>下载对应的cms分析目录</p>
<p>审计该cms源码漏洞</p>
<h4>4.5.1.6.&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160; WAF</h4>
<h3 id="h3-6">4.6.&#160;&#160; 谷歌hacker</h3>
<h4>4.6.1.1.&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160; Intext：</h4>
<p>查找网页中含有xx关键字的网站&#160;&#160;&#160;&#160; 例：intext：管理员登陆</p>
<h4>4.6.1.2.&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160; Intitle：</h4>
<p>查找某个标题&#160;&#160;&#160; 例：intitle：后台登陆</p>
<h4>4.6.1.3.&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160; Filetype：</h4>
<p>查找某个文件类型的文件&#160;&#160;&#160;&#160; 例：数据挖掘filetype：doc</p>
<h4>4.6.1.4.&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160; Inurl：</h4>
<p>查找url中带有某字段的网站&#160;&#160;&#160;&#160; 例：inurl：php？id=</p>
<h4>4.6.1.5.&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160; Site：</h4>
<p>中某域名中查找信息</p>
<h3 id="h3-7">4.7.&#160;&#160; url采集</h3>
<h4>4.7.1.1.&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160; 采集相关url的同类网站</h4>
<h4>4.7.1.2.&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160; 例如</h4>
<p>Php？id=</p>
<p>漏洞网站</p>
<p>相同某种指纹网站</p>
<h4>4.7.1.3.&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160; 常用工具</h4>
<p>谷歌hacker</p>
<p>url采集器</p>
<h3 id="h3-8">4.8.&#160;&#160; 信息分析</h3>
<h3 id="h3-9">4.9.&#160;&#160; 服务器方向信息收集</h3>
<h4>4.9.1.1.&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160; 服务信息收集</h4>
<p>网络服务：web/ftp/telnet/ssh/mail/mysql/mssql/oracle/rdp</p>
<p>服务版本，漏洞等相关信息收集</p>
<h4>4.9.1.2.&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160; 系统版本信息收集</h4>
<h1>5.&#160;&#160; 网络设备信息收集</h1>
<h4>5.1.1.1.&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160; 网络开放端口</h4>
<h4>5.1.1.2.&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160; 路由</h4>
<h4>5.1.1.3.&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160; 防火墙</h4>
<h4>5.1.1.4.&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160; 代理服务器等相关设备的收集</h4>
<h4>5.1.1.5.&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160; Shodan</h4>
<h1>6.&#160;&#160; 后台查找</h1>
<p>弱口令默认后台：admin，admin/login.asp，manage，asp等</p>
<p>查找网页等链接：一般来说，网站等主页有管理登陆类似的东西，有些</p>
<p>查找网站图片的属性</p>
<p>查找网站使用的管理系统，从而确定后台</p>
<p>用工具查找：wwwscan，intellitamper，御剑</p>
<p>txt的帮助：robots.txt文件告诉蜘蛛程序中服务器上什么样的文件</p>
<p>Googlehacker</p>
<p>查看网站使用的编辑器上否有默认后台</p>
<p>短文件利用</p>
<p>sqlmap –sql-shel load_file(‘d:/wwwroot/index.php’)</p>
<p>找关联性信息</p>
<p>同一个建站商</p>
<p>同一个注册邮箱</p>
<p>同一个注册人</p>
<p>后台可能不在同一个站</p>
<ul><li>端口后台</li>
<li>子域名</li>
</ul>
<p>Admin.baidu.com</p>
<p>System.baidu.com</p>
<ul><li>可能是完全独立的另一个域名</li>
</ul>
<p>如果是同一个服务器可以查旁站</p>
<h3 id="h3-10">6.1.&#160;&#160; CDN绕过</h3>
<p>判断CDN（超级ping）</p>
<p><strong>绕过：</strong>
</p>
<p>查找二级域名</p>
<p>让服务器主动给你发包（邮件）</p>
<p>敏感目录泄漏</p>
<p>查询历史解析ip</p>
<p>访问绕过CDN（修改hosts文件）</p>
<h1>7.&#160;&#160; Kali—信息收集</h1>
<h3 id="h3-11">7.1.&#160;&#160; Robots文件探测</h3>
<p>获取网站隐藏敏感目录活文件</p>
<p>比如：安装目录、上传目录、编辑器目录、管理目录、管理页面等</p>
<p>例：www.baidu.com/robots.txt</p>
<h3 id="h3-12">7.2.&#160;&#160; DNS信息收集</h3>
<p>搜集网站域名信息，如子域名，其他域名，解析服务器，区域传送漏洞等</p>
<p>常用工具：dnsenum、dig、fierce</p>
<p>Whois信息搜集</p>
<p>Whois baidu.com</p>
<h4>7.2.1.1.&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160; Dnsenum</h4>
<p>Dnsenum可以通过字典或谷歌猜测可能存在的域名，并对一个网段进行反查</p>
<p>Dnsenum –enum baidu.com 获取其他域名<img src="https://image.3001.net/images/20220726/1658828560_62dfb7103374b9888bc36.png!small?1658828560750" alt="1658828560_62dfb7103374b9888bc36.png!small?1658828560750" data-pswp-uid="1" /></p>
<p>-r 允许用户设置递归查询</p>
<p>-w 允许用户设置whois请求</p>
<p>-o 允许用户指定输入文件位置</p>
<h3 id="h3-13">7.3.&#160;&#160; 敏感目录探测</h3>
<h5>7.3.1.1.1.&#160;&#160;&#160;&#160;&#160; 暴力破解</h5>
<p>暴力破解的方法就是需要一个强大的目录名称字典，用来尝试逐个匹配，如果存在通过响应码的回显来确定目录或页面是否存在</p>
<h5>7.3.1.1.2.&#160;&#160;&#160;&#160;&#160; 目录爬行</h5>
<p>目录爬行原理是通过一些自带网络蜘蛛爬行的工具对网站链接进行快速爬行</p>
<h4>7.3.1.2.&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160; Dirb</h4>
<p>-a 改变ua 躲避安全狗</p>
<p>-b指定扫描路径</p>
<p>-c 指定cookie</p>
<p>-p 代理设置</p>
<p>Dirb <a href="http://www.baidu.com">http://www.baidu.com</a>-a Mozilla/5.0“</p>
<p>(compatible;Baiduspider/2.0;+http://www.baidu.com/search/spider.html)”</p>
<p><img src="https://image.3001.net/images/20220726/1658828616_62dfb7486ae08e426cbd6.png!small?1658828616954" alt="1658828616_62dfb7486ae08e426cbd6.png!small?1658828616954" data-pswp-uid="2" /></p>
<p>当然也有图形界面的工具</p>
<h4>7.3.1.3.&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160; Dirbuster&#160; &#160; <img src="https://image.3001.net/images/20220726/1658828649_62dfb769e934600f43490.png!small?1658828650641" alt="1658828649_62dfb769e934600f43490.png!small?1658828650641" data-pswp-uid="3" /></h4>
<h3 id="h3-14">7.4.&#160;&#160; 端口探测</h3>
<h3 id="h3-15">7.5.&#160;&#160; 整站识别</h3>
<h3 id="h3-16">7.6.&#160;&#160; Whatweb</h3>
<p>用来识别网站cms及大家平台环境的工具</p>
<p>Whatweb -v <a href="http://baidu.com">http://baidu.com</a>
</p>
<p>平台、脚本、cms、容器、数据库等信息探测</p>
<h3 id="h3-17">7.7.&#160;&#160; Waf探测</h3>
<p>Wafwoof</p>
<p>用来探测waf等一个工具（不推荐）</p>
<p>Wafw00f http://www.baidu.com</p>
<h3 id="h3-18">7.8.&#160;&#160; 工具型站的使用</h3>
<h3 id="h3-19">7.9.&#160;&#160; Google语法</h3>
<h1>8.&#160;&#160; 信息收集的分类（详细篇）</h1>
<p>服务器的相关信息（真实ip，系统类型，版本，开放端口，WAF等）</p>
<p>网站指纹识别（包括，cms，cdn，证书等） dns记录</p>
<p>whois信息，姓名，备案，邮箱，电话反查（邮箱丢社工库，社工准备等）</p>
<p>子域名收集，旁站，C段等</p>
<p>google hacking针对化搜索，word/电子表格/pdf文件，中间件版本，弱口令扫描等</p>
<p>扫描网站目录结构，爆后台，网站banner，测试文件，备份等敏感文件泄漏等</p>
<p>传输协议，通用漏洞，exp，github源码等</p>
<h1>9.&#160;&#160; 常见的方法有</h1>
<ol><li>whois查询</li>
</ol>
<p>域名在注册的时候 需要填入个人或者企业信息 如果没有设置隐藏属性可以查询出来 通过备案号 查询个人或者企业信息 也可以whois反查注册人 邮箱 电话 机构 反查更多得域名和需要得信息。</p>
<ol><li>收集子域名</li>
</ol>
<p>域名分为根域名和子域名</p>
<p>baidu.com 根域名 顶级域名</p>
<p>www.baidu.com子域名 也叫二级域名</p>
<p>www.wiki.baidu.com&#160; 子域名 也叫三级域名 四级如此类推</p>
<ol><li>端口扫描</li>
</ol>
<p>服务器需要开放服务，就必须开启端口，常见的端口是tcp 和udp两种类型</p>
<p>范围 0-65535 通过扫得到的端口，访问服务 规划下一步渗透。</p>
<ol><li>查找真实ip</li>
</ol>
<p>企业的网站，为了提高访问速度，或者避免黑客攻击，用了cdn服务，用了cdn之后真实服务器ip会被隐藏。</p>
<ol><li>探测旁站及C段</li>
</ol>
<p>旁站:一个服务器上有多个网站 通过ip查询服务器上的网站</p>
<p>c段:查找同一个段 服务器上的网站。可以找到同样网站的类型和服务器，也可以获取同段服务器进行下一步渗透。</p>
<ol><li>网络空间搜索引擎</li>
</ol>
<p>通过这些引擎查找网站或者服务器的信息，进行下一步渗透。</p>
<ol><li>扫描敏感目录/文件</li>
</ol>
<p>通过扫描目录和文件，大致了解网站的结构，获取突破点，比如后台，文件备份，上传点。</p>
<ol><li>指纹识别</li>
</ol>
<p>获取网站的版本，属于那些cms管理系统，查找漏洞exp，下载cms进行代码审计。</p>
<h1>10.&#160;&#160;&#160;&#160;&#160;&#160;&#160; 在线whois查询</h1>
<p>通过whois来对域名信息进行查询，可以查到注册商、注册人、邮箱、DNS解析服务器、注册人联系电话等，因为有些网站信息查得到，有些网站信息查不到，所以推荐以下信息比较全的查询网站，直接输入目标站点即可查询到相关信息。</p>
<p>站长之家域名WHOIS信息查询地址 http://whois.chinaz.com/</p>
<p>爱站网域名WHOIS信息查询地址 https://whois.aizhan.com/</p>
<p>腾讯云域名WHOIS信息查询地址 https://whois.cloud.tencent.com/</p>
<p>美橙互联域名WHOIS信息查询地址 https://whois.cndns.com/</p>
<p>爱名网域名WHOIS信息查询地址 https://www.22.cn/domain/</p>
<p>易名网域名WHOIS信息查询地址 https://whois.ename.net/</p>
<p>中国万网域名WHOIS信息查询地址 https://whois.aliyun.com/</p>
<p>西部数码域名WHOIS信息查询地址 https://whois.west.cn/</p>
<p>新网域名WHOIS信息查询地址 http://whois.xinnet.com/domain/whois/index.jsp</p>
<p>纳网域名WHOIS信息查询地址 http://whois.nawang.cn/</p>
<p>中资源域名WHOIS信息查询地址 https://www.zzy.cn/domain/whois.html</p>
<p>三五互联域名WHOIS信息查询地址 https://cp.35.com/chinese/whois.php</p>
<p>新网互联域名WHOIS信息查询地址 http://www.dns.com.cn/show/domain/whois/index.do</p>
<p>国外WHOIS信息查询地址 https://who.is/</p>
<h3 id="h3-20">10.1. 在线网站备案查询</h3>
<p>网站备案信息是根据国家法律法规规定，由网站所有者向国家有关部门申请的备案，如果需要查询企业备案信息（单位名称、备案编号、网站负责人、电子邮箱、联系电话、法人等），推荐以下网站查询</p>
<blockquote><p>天眼查 <a href="https://www.tianyancha.com/">https://www.tianyancha.com/</a>
</p>
<p>ICP备案查询网<a href="http://www.beianbeian.com/">http://www.beianbeian.com/</a>
</p>
<p>爱站备案查询https://icp.aizhan.com/</p>
<p>域名助手备案信息查询 <a href="http://cha.fute.com/index">http://cha.fute.com/index﻿</a>
</p>
</blockquote>
<h1>11.&#160;&#160;&#160;&#160;&#160;&#160;&#160; 查询绿盟的whois信息</h1>
<p>nsfocus.com.cn</p>
<p>Whois查询nsfocus.com.cn</p>
<p><img src="https://image.3001.net/images/20220726/1658828727_62dfb7b7aee2e17b89bf4.png!small" alt="1658828727_62dfb7b7aee2e17b89bf4.png!small" data-pswp-uid="4" /></p>
<p>通过反查注册人和邮箱得多更多得域名</p>
<p><img src="https://image.3001.net/images/20220726/1658828820_62dfb8147692a2f3c838b.png!small?1658828820893" alt="1658828820_62dfb8147692a2f3c838b.png!small?1658828820893" data-pswp-uid="5" /></p>
<p><img src="https://image.3001.net/images/20220726/1658828862_62dfb83ec92fc616af184.png!small?1658828863305" alt="1658828862_62dfb83ec92fc616af184.png!small?1658828863305" data-pswp-uid="6" /></p>
<p><img src="https://image.3001.net/images/20220726/1658829050_62dfb8fa27c9ef8f2b8f0.png!small?1658829050935" alt="1658829050_62dfb8fa27c9ef8f2b8f0.png!small?1658829050935" data-pswp-uid="7" /></p>
<h1>12.&#160;&#160;&#160;&#160;&#160;&#160;&#160; 收集子域名</h1>
<h3 id="h3-21">12.1. 子域名作用</h3>
<p>收集子域名可以扩大测试范围，同一域名下的二级域名都属于目标范围。</p>
<h3 id="h3-22">12.2. 常用方式</h3>
<p>子域名中的常见资产类型一般包括办公系统，邮箱系统，论坛，商城，其他管理系统，网站管理后台也有可能出现子域名中。</p>
<p>首先找到目标站点，在官网中可能会找到相关资产（多为办公系统，邮箱系统等），关注一下页面底部，也许有管理后台等收获。</p>
<p>查找目标域名信息的方法有：</p>
<ol><li>FOFA title="公司名称"</li>
<li>百度 intitle=公司名称</li>
<li>Google intitle=公司名称</li>
<li>站长之家，直接搜索名称或者网站域名即可查看相关信息：</li>
</ol>
<p>http://tool.chinaz.com/</p>
<ol><li>钟馗之眼 site=域名即可</li>
</ol>
<p><a href="https://www.zoomeye.org/">https://www.zoomeye.org/</a>
</p>
<p>找到官网后，再收集子域名，下面推荐几种子域名收集的方法，直接输入domain即可查询</p>
<h3 id="h3-23">12.3. 域名的类型</h3>
<p>A记录、别名记录(CNAME)、MX记录、TXT记录、NS记录：</p>
<p><strong>12.3.1.&#160; A (Address) 记录：</strong>
</p>
<p>是用来指定主机名（或域名）对应的IP地址记录。用户可以将该域名下的网站服务器指向到自己的web server上。同时也可以设置您域名的二级域名。</p>
<p><strong>12.3.2.&#160; 别名(CNAME)记录：</strong>
</p>
<p>也被称为规范名字。这种记录允许您将多个名字映射到同一台计算机。通常用于同时提供WWW和MAIL服务的计算机。例如，有一台计算机名为“host.mydomain.com”（A记录）。它同时提供WWW和MAIL服务，为了便于用户访问服务。可以为该计算机设置两个别名（CNAME）：WWW和MAIL。这两个别名的全称就是“www.mydomain.com”和“mail.mydomain.com”。实际上他们都指向“host.mydomain.com”。</p>
<p>同样的方法可以用于当您拥有多个域名需要指向同一服务器IP，此时您就可以将一个域名做A记录指向服务器IP然后将其他的域名做别名到之前做A记录的域名上，那么当您的服务器IP地址变更时您就可以不必麻烦的一个一个域名更改指向了 只需要更改做A记录的那个域名其他做别名的那些域名的指向也将自动更改到新的IP地址上了。</p>
<p><strong>12.3.3.&#160; 如何检测CNAME记录？</strong>
</p>
<p>1、进入命令状态；（开始菜单 - 运行 - CMD[回车]）；</p>
<p>2、输入命令" nslookup -q=cname 这里填写对应的域名或二级域名"，查看返回的结果与设置的是否一致即可。</p>
<p id="h3-24"><strong>12.3.4.&#160; MX（Mail Exchanger）记录：</strong>
</p>
<p>是邮件交换记录，它指向一个邮件服务器，用于电子邮件系统发邮件时根据 收信人的地址后缀来定位邮件服务器。例如，当Internet上的某用户要发一封信给 user@mydomain.com 时，该用户的邮件系统通过DNS查找mydomain.com这个域名的MX记录，如果MX记录存在， 用户计算机就将邮件发送到MX记录所指定的邮件服务器上。</p>
<p id="h3-25"><strong>12.3.5.&#160; 什么是TXT记录？：</strong>
</p>
<p>TXT记录一般指为某个主机名或域名设置的说明，如：</p>
<p>1）admin IN TXT "jack, mobile:13800138000"；</p>
<p>2）mail IN TXT "邮件主机, 存放在xxx ,管理人：AAA"，Jim IN TXT "contact: abc@mailserver.com"</p>
<p>也就是您可以设置 TXT ，以便使别人联系到您。</p>
<p>如何检测TXT记录？</p>
<p>1、进入命令状态；（开始菜单 - 运行 - CMD[回车]）；</p>
<p>2、输入命令" nslookup -q=txt 这里填写对应的域名或二级域名"，查看返回的结果与设置的是否一致即可。</p>
<p id="h3-26"><strong>12.3.6.&#160; 什么是NS记录？</strong>
</p>
<p>ns记录全称为Name Server 是一种域名服务器记录，用来明确当前你的域名是由哪个DNS服务器来进行解析的。</p>
<p id="h3-27"><strong>12.3.7.&#160; 子域名在线查询1</strong>
</p>
<p><a href="https://phpinfo.me/domain/">https://phpinfo.me/domain/<img src="https://image.3001.net/images/20220726/1658829073_62dfb91171165ff94c455.png!small?1658829074000" alt="1658829073_62dfb91171165ff94c455.png!small?1658829074000" data-pswp-uid="8" /></a>
</p>
<p id="h3-28"><strong>12.3.8.&#160; 子域名在线查询2</strong>
</p>
<p><a href="https://www.t1h2ua.cn/tools/">https://www.t1h2ua.cn/tools/</a>
</p>
<p><img src="https://image.3001.net/images/20220726/1658829087_62dfb91f636b5c62850e2.png!small?1658829088139" alt="1658829087_62dfb91f636b5c62850e2.png!small?1658829088139" data-pswp-uid="9" /></p>
<p id="h3-29"><strong>12.3.9.&#160; dns侦测</strong>
</p>
<h3><a href="https://dnsdumpster.com/">https://dnsdumpster.com/</a>
</h3>
<p><img src="https://image.3001.net/images/20220726/1658829109_62dfb935076c2f0fac1c9.png!small?1658829109546" alt="1658829109_62dfb935076c2f0fac1c9.png!small?1658829109546" data-pswp-uid="10" /></p>
<p id="h3-31"><strong>12.3.10.&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160; IP138查询子域名</strong>
</p>
<p><a href="https://site.ip138.com/moonsec.com/domain.htm">https://site.ip138.com/baidu.com/domain.htm</a>
</p>
<p><img src="https://image.3001.net/images/20220726/1658829115_62dfb93b56d8ac01ab15c.png!small?1658829116271" alt="1658829115_62dfb93b56d8ac01ab15c.png!small?1658829116271" data-pswp-uid="11" /></p>
<p id="h3-32"><strong>12.3.11.&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160; FOFA搜索子域名</strong>
</p>
<p>https://fofa.so/</p>
<p>语法：domain="baidu.com"<img src="https://image.3001.net/images/20220726/1658829128_62dfb9482ff162a4515f9.png!small?1658829129170" alt="1658829128_62dfb9482ff162a4515f9.png!small?1658829129170" data-pswp-uid="12" /></p>
<p>提示：以上两种方法无需爆破，查询速度快，需要快速收集资产时可以优先使用，后面再用其他方法补充。</p>
<p id="h3-33"><strong>12.3.12.&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160; Hackertarget查询子域名</strong>
</p>
<p>https://hackertarget.com/find-dns-host-records/</p>
<p>注意：通过该方法查询子域名可以得到一个目标大概的ip段，接下来可以通过ip来收集信息。</p>
<h3>12.4. 360测绘空间</h3>
<p><a href="https://quake.360.cn/">https://quake.360.cn/</a>
</p>
<p>domain:"*.freebuf.com"</p>
<p id="h3-34"><strong>12.4.1.&#160; Layer子域名挖掘机</strong>
<img src="https://image.3001.net/images/20220726/1658829204_62dfb994e36eb33bd525c.png!small?1658829205479" alt="1658829204_62dfb994e36eb33bd525c.png!small?1658829205479" data-pswp-uid="13" /></p>
<p id="h3-35"><strong>12.4.2.&#160; SubDomainBrute</strong>
</p>
<p>pip install aiodns</p>
<p><img src="https://image.3001.net/images/20220726/1658829209_62dfb999dde24670eac7c.png!small?1658829210420" alt="1658829209_62dfb999dde24670eac7c.png!small?1658829210420" data-pswp-uid="14" /></p>
<p>运行命令subDomainsBrute.py freebuf.com</p>
<p>subDomainsBrute.py&#160; freebuf.com --full -o freebuf2.txt</p>
<p id="h3-36"><strong>12.4.3.&#160; Sublist3r</strong>
</p>
<p><a href="https://github.com/aboul3la/Sublist3r">https://github.com/aboul3la/Sublist3r</a>
</p>
<p>pip install -r requirements.txt</p>
<p>提示：以上方法为爆破子域名，由于字典比较强大，所以效率较高。</p>
<p><strong>帮助文档</strong>
</p>
<pre>usage: sublist3r.py [-h] -d DOMAIN [-b [BRUTEFORCE]] [-p PORTS] [-v [VERBOSE]]

[-t THREADS] [-e ENGINES] [-o OUTPUT] [-n]

OPTIONS:

-h, --help&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160; show this help message and exit

-d DOMAIN, --domain DOMAIN

Domain name to enumerate it's subdomains

-b [BRUTEFORCE], --bruteforce [BRUTEFORCE]

Enable the subbrute bruteforce module

-p PORTS, --ports PORTS

Scan the found subdomains against specified tcp ports

-v [VERBOSE], --verbose [VERBOSE]

Enable Verbosity and display results in realtime

-t THREADS, --threads THREADS

Number of threads to use for subbrute bruteforce

-e ENGINES, --engines ENGINES

Specify a comma-separated list of search engines

-o OUTPUT, --output OUTPUT

Save the results to text file

-n, --no-color&#160;&#160;&#160;&#160;&#160;&#160;&#160; Output without color</pre>
<p>Example: python sublist3r.py -d google.com</p>
<p><strong>中文翻译</strong>
</p>
<p>-h ：帮助</p>
<p>-d ：指定主域名枚举子域名</p>
<p>-b ：调用subbrute暴力枚举子域名</p>
<p>-p ：指定tpc端口扫描子域名</p>
<p>-v ：显示实时详细信息结果</p>
<p>-t ：指定线程</p>
<p>-e ：指定搜索引擎</p>
<p>-o ：将结果保存到文本</p>
<p>-n ：输出不带颜色</p>
<p><strong>默认参数扫描子域名</strong>
</p>
<p>python sublist3r.py -d baidu.com</p>
<p><strong>使用暴力枚举子域名</strong>
</p>
<p>python sublist3r -b -d baidu.com</p>
<p><strong>12.4.4.&#160; python2.7.14 环境</strong>
</p>
<p>;C:\Python27;C:\Python27\Scripts</p>
<p><strong>12.4.5.&#160; OneForALL</strong>
</p>
<p>pip3 install --user -r requirements.txt -i <a href="https://mirrors.aliyun.com/pypi/simple/">https://mirrors.aliyun.com/pypi/simple/</a>
</p>
<p>python3 oneforall.py --target baidu.com run /*收集*/</p>
<p><img src="https://image.3001.net/images/20220726/1658829232_62dfb9b0b693a49499e72.png!small?1658829233978" alt="1658829232_62dfb9b0b693a49499e72.png!small?1658829233978" data-pswp-uid="15" /></p>
<p>爆破子域名</p>
<p>Example：</p>
<pre>brute.py --target domain.com --word True run

brute.py --targets ./domains.txt --word True run

brute.py --target domain.com --word True --concurrent 2000 run

brute.py --target domain.com --word True --wordlist subnames.txt run

brute.py --target domain.com --word True --recursive True --depth 2 run

brute.py --target d.com --fuzz True --place m.*.d.com --rule '[a-z]' run

brute.py --target d.com --fuzz True --place m.*.d.com --fuzzlist subnames.txt run</pre>
<p><img src="https://image.3001.net/images/20220726/1658829373_62dfba3d07cdde687877a.png!small?1658829374065" alt="1658829373_62dfba3d07cdde687877a.png!small?1658829374065" data-pswp-uid="16" /></p>
<p><strong>12.4.6.&#160; Wydomain</strong>
</p>
<pre>dnsburte.py -d aliyun.com -f dnspod.csv -o aliyun.log

wydomain.py -d aliyun.com</pre>
<p><strong>12.4.7.&#160; FuzzDomain</strong>
</p>
<p><img src="https://image.3001.net/images/20220726/1658829377_62dfba41828ca9707bdb0.png!small?1658829378949" alt="1658829377_62dfba41828ca9707bdb0.png!small?1658829378949" data-pswp-uid="17" /></p>
<p id="h3-30"><strong>12.4.8.&#160; 隐藏域名hosts碰撞</strong>
</p>
<p>隐藏资产探测-hosts碰撞</p>
<p><a href="https://mp.weixin.qq.com/s/fuASZODw1rLvgT7GySMC8Q">https://mp.weixin.qq.com/s/fuASZODw1rLvgT7GySMC8Q</a>
</p>
<p>很多时候访问目标资产IP响应多为：401、403、404、500，但是用域名请求却能返回正常的业务系统（禁止IP直接访问），因为这大多数都是需要绑定host才能正常请求访问的 （目前互联网公司基本的做法）（域名删除了A记录，但是反代的配置未更新），那么我们就可以通过收集到的目标的 域名 和 目标资产 的IP段组合起来，以 IP段+域名 的形式进行捆绑碰撞，就能发现很多有意思的东西。</p>
<p>在发送http请求的时候，对域名和IP列表进行配对，然后遍历发送请求 （就相当于修改了本地的hosts文件一样），并把相应的title和响应包大小拿回 来做对比，即可快速发现一些隐蔽的资产。</p>
<p>进行hosts碰撞需要目标的域名和目标的相关IP作为字典</p>
<p>域名就不说了</p>
<p>相关IP来源有：</p>
<p>目标域名历史解析IP</p>
<p>https://site.ip138.com/</p>
<p><a href="https://ipchaxun.com/">https://ipchaxun.com/﻿</a>
</p>
<p>ip正则</p>
<p><a href="https://www.aicesu.cn/reg/">https://www.aicesu.cn/reg/</a>
</p>
<h1>13.&#160;&#160;&#160;&#160;&#160;&#160;&#160; 端口扫描</h1>
<p>当确定了目标大概的ip段后，可以先对ip的开放端口进行探测，一些特定服务可能开起在默认端口上，探测开放端口有利于快速收集目标资产，找到目标网站的其他功能站点。</p>
<h3>13.1. msscan端口扫描</h3>
<p>msscan -p 1-65535 ip --rate=1000</p>
<p><a href="https://gitee.com/youshusoft/GoScanner/">https://gitee.com/youshusoft/GoScanner/</a>
</p>
<p id="h2-2"><strong>13.2. 御剑端口扫描工具</strong>
<img src="https://image.3001.net/images/20220726/1658829395_62dfba531e83d16bded6d.png!small?1658829395639" alt="1658829395_62dfba531e83d16bded6d.png!small?1658829395639" data-pswp-uid="18" /></p>
<p id="h2-3"><strong>13.3. nmap扫描端口和探测端口信息</strong>
</p>
<p>常用参数，如：</p>
<p>nmap -sV 192.168.0.2</p>
<p>nmap -sT 92.168.0.2</p>
<p>nmap -Pn -A -sC 192.168.0.2</p>
<p>nmap -sU -sT -p0-65535 192.168.122.1</p>
<p>用于扫描目标主机服务版本号与开放的端口</p>
<p>如果需要扫描多个ip或ip段，可以将他们保存到一个txt文件中</p>
<p>nmap -iL ip.txt</p>
<p>来扫描列表中所有的ip。</p>
<p>Nmap为端口探测最常用的方法，操作方便，输出结果非常直观。</p>
<p id="h2-4"><strong>13.4. 在线端口检测</strong>
</p>
<p>http://coolaf.com/tool/port</p>
<p><img src="https://image.3001.net/images/20220726/1658829406_62dfba5e92731c4f7ec57.png!small?1658829407087" alt="1658829406_62dfba5e92731c4f7ec57.png!small?1658829407087" data-pswp-uid="19" /></p>
<p id="h2-5"><strong>13.5. 端口扫描器</strong>
</p>
<p><img src="https://image.3001.net/images/20220726/1658829966_62dfbc8ebe175cbea27ce.gif!small?1658829967266" alt="1658829966_62dfbc8ebe175cbea27ce.gif!small?1658829967266" data-pswp-uid="20" /></p>
<p>御剑，msscan，nmap等</p>
<p>御剑高速端口扫描器：</p>
<p>填入想要扫描的ip段（如果只扫描一个ip，则开始IP和结束IP填一个即可），可以选择不改默认端口列表，也可以选择自己指定端口。</p>
<h3>13.6. 渗透端口</h3>
<p>21,22,23,1433,152,3306,3389,5432,5900,50070,50030,50000,27017,27018,11211,9200,9300,7001,7002,6379,5984,873,443,8000-9090,80-89,80,10000,8888,8649,8083,8080,8089,9090,7778,7001,7002,6082,5984,4440,3312,3311,3128,2601,2604,2222,2082,2083,389,88,512,513,514,1025,111,1521,445,135,139,53</p>
<h3>13.7. 渗透常见端口及对应服务</h3>
<p>1.web类(web漏洞/敏感目录)</p>
<p>第三方通用组件漏洞struts thinkphp jboss ganglia zabbix</p>
<p>80 web</p>
<p>80-89 web</p>
<p>8000-9090 web</p>
<p>2.数据库类(扫描弱口令)</p>
<p>1433 MSSQL</p>
<p>1521 Oracle</p>
<p>3306 MySQL</p>
<p>5432 PostgreSQL</p>
<p>3.特殊服务类(未授权/命令执行类/漏洞)</p>
<p>443 SSL心脏滴血</p>
<p>873 Rsync未授权</p>
<p>5984 CouchDB http://xxx:5984/_utils/</p>
<p>6379 redis未授权</p>
<p>7001,7002 WebLogic默认弱口令，反序列</p>
<p>9200,9300 elasticsearch 参考WooYun: 多玩某服务器ElasticSearch命令执行漏洞</p>
<p>11211 memcache未授权访问</p>
<p>27017,27018 Mongodb未授权访问</p>
<p>50000 SAP命令执行</p>
<p>50070,50030 hadoop默认端口未授权访问</p>
<p>4.常用端口类(扫描弱口令/端口爆破)</p>
<p>21 ftp</p>
<p>22 SSH</p>
<p>23 Telnet</p>
<p>2601,2604 zebra路由，默认密码zebra</p>
<p>3389 远程桌面</p>
<p>5.端口合计详情</p>
<p>21 ftp</p>
<p>22 SSH</p>
<p>23 Telnet</p>
<p>80 web</p>
<p>80-89 web</p>
<p>161 SNMP</p>
<p>389 LDAP</p>
<p>443 SSL心脏滴血以及一些web漏洞测试</p>
<p>445 SMB</p>
<p>512,513,514 Rexec</p>
<p>873 Rsync未授权</p>
<p>1025,111 NFS</p>
<p>1433 MSSQL</p>
<p>1521 Oracle:(iSqlPlus Port:5560,7778)</p>
<p>2082/2083 cpanel主机管理系统登陆 （国外用较多）</p>
<p>2222 DA虚拟主机管理系统登陆 （国外用较多）</p>
<p>2601,2604 zebra路由，默认密码zebra</p>
<p>3128 squid代理默认端口，如果没设置口令很可能就直接漫游内网了</p>
<p>3306 MySQL</p>
<p>3312/3311 kangle主机管理系统登陆</p>
<p>3389 远程桌面</p>
<p>4440 rundeck 参考WooYun: 借用新浪某服务成功漫游新浪内网</p>
<p>5432 PostgreSQL</p>
<p>5900 vnc</p>
<p>5984 CouchDB http://xxx:5984/_utils/</p>
<p>6082 varnish 参考WooYun: Varnish HTTP accelerator CLI 未授权访问易导致网站被直接篡改或者作为代理进入内网</p>
<p>6379 redis未授权</p>
<p>7001,7002 WebLogic默认弱口令，反序列</p>
<p>7778 Kloxo主机控制面板登录</p>
<p>8000-9090 都是一些常见的web端口，有些运维喜欢把管理后台开在这些非80的端口上</p>
<p>8080 tomcat/WDCP主机管理系统，默认弱口令</p>
<p>8080,8089,9090 JBOSS</p>
<p>8083 Vestacp主机管理系统 （国外用较多）</p>
<p>8649 ganglia</p>
<p>8888 amh/LuManager 主机管理系统默认端口</p>
<p>9200,9300 elasticsearch 参考WooYun: 多玩某服务器ElasticSearch命令执行漏洞</p>
<p>10000 Virtualmin/Webmin 服务器虚拟主机管理系统</p>
<p>11211 memcache未授权访问</p>
<p>27017,27018 Mongodb未授权访问</p>
<p>28017 mongodb统计页面</p>
<p>50000 SAP命令执行</p>
<p>50070,50030 hadoop默认端口未授权访问</p>
<h3>13.8. 常见的端口和攻击方法</h3>
<p><img src="https://image.3001.net/images/20220726/1658829994_62dfbcaa18ddc3ce4198b.gif!small?1658829994791" alt="1658829994_62dfbcaa18ddc3ce4198b.gif!small?1658829994791" data-pswp-uid="21" /></p>
<h1>14.&#160;&#160;&#160;&#160;&#160;&#160;&#160; 查找真实ip</h1>
<p>如果目标网站使用了CDN，使用了cdn真实的ip会被隐藏，如果要查找真实的服务器就必须获取真实的ip，根据这个ip继续查询旁站。</p>
<p>注意：很多时候，主站虽然是用了CDN，但子域名可能没有使用CDN，如果主站和子域名在一个ip段中，那么找到子域名的真实ip也是一种途径。</p>
<h3>14.1. 多地ping确认是否使用CDN</h3>
<p>http://ping.chinaz.com/</p>
<p>http://ping.aizhan.com/<img src="https://image.3001.net/images/20220726/1658830018_62dfbcc2b1648916d72b6.gif!small?1658830019247" alt="1658830018_62dfbcc2b1648916d72b6.gif!small?1658830019247" data-pswp-uid="22" /></p>
<h3>14.2. 查询历史DNS解析记录</h3>
<p>在查询到的历史解析记录中，最早的历史解析ip很有可能记录的就是真实ip，快速查找真实IP推荐此方法，但并不是所有网站都能查到。</p>
<p><strong>14.2.1.&#160; DNSDB</strong>
</p>
<p>https://dnsdb.io/zh-cn/</p>
<p><strong>14.2.2.&#160; 微步在线</strong>
</p>
<p><a href="https://x.threatbook.cn/">https://x.threatbook.cn/</a>
</p>
<p><img src="https://image.3001.net/images/20220726/1658830031_62dfbccf3573fa2559216.gif!small?1658830031708" alt="1658830031_62dfbccf3573fa2559216.gif!small?1658830031708" data-pswp-uid="23" /></p>
<p><strong>14.2.3.&#160; Ipip.net</strong>
</p>
<p><a href="https://tools.ipip.net/cdn.php">https://tools.ipip.net/cdn.php<img src="https://image.3001.net/images/20220726/1658830043_62dfbcdbf41f6f2d6724f.gif!small?1658830044446" alt="1658830043_62dfbcdbf41f6f2d6724f.gif!small?1658830044446" data-pswp-uid="24" /></a>
</p>
<p><strong>14.2.4.&#160; viewdns</strong>
</p>
<p>https://viewdns.info/<img src="https://image.3001.net/images/20220726/1658830047_62dfbcdfca11974707f21.gif!small?1658830048216" alt="1658830047_62dfbcdfca11974707f21.gif!small?1658830048216" data-pswp-uid="25" /></p>
<h3>14.3. phpinfo</h3>
<p>如果目标网站存在phpinfo泄露等，可以在phpinfo中的SERVER_ADDR或_SERVER[“SERVER_ADDR"]找到真实ip</p>
<h3>14.4. 绕过CDN</h3>
<p>绕过CDN的多种方法具体可以参考 https://www.cnblogs.com/qiudabai/p/9763739.html<img src="https://image.3001.net/images/20220726/1658830070_62dfbcf630ee5e298a012.gif!small?1658830070695" alt="1658830070_62dfbcf630ee5e298a012.gif!small?1658830070695" data-pswp-uid="26" /><img src="https://image.3001.net/images/20220726/1658830079_62dfbcff436a42198585b.gif!small?1658830079773" alt="1658830079_62dfbcff436a42198585b.gif!small?1658830079773" data-pswp-uid="27" /></p>
<h1>15.&#160;&#160;&#160;&#160;&#160;&#160;&#160; 旁站和C段</h1>
<p>旁站往往存在业务功能站点，建议先收集已有IP的旁站，再探测C段，确认C段目标后，再在C段的基础上再收集一次旁站。</p>
<p>旁站是和已知目标站点在同一服务器但不同端口的站点，通过以下方法搜索到旁站后，先访问一下确定是不是自己需要的站点信息。</p>
<h3>15.1.1.&#160; 站长之家</h3>
<p>同ip网站查询http://stool.chinaz.com/same</p>
<p>https://chapangzhan.com/</p>
<h3>15.2. google hacking</h3>
<p>https://blog.csdn.net/qq_36119192/article/details/84029809</p>
<p><strong>15.2.1.&#160; 网络空间搜索引擎</strong>
</p>
<p>如FOFA搜索旁站和C段</p>
<p>该方法效率较高，并能够直观地看到站点标题，但也有不常见端口未收录的情况，虽然这种情况很少，但之后补充资产的时候可以用下面的方法nmap扫描再收集一遍。</p>
<p><img src="https://image.3001.net/images/20220726/1658830116_62dfbd24bffa9b56b84e9.gif!small?1658830117312" alt="1658830116_62dfbd24bffa9b56b84e9.gif!small?1658830117312" data-pswp-uid="28" /><img src="https://image.3001.net/images/20220726/1658830143_62dfbd3f39b5d59a2e356.gif!small?1658830143816" alt="1658830143_62dfbd3f39b5d59a2e356.gif!small?1658830143816" data-pswp-uid="29" /></p>
<p id="h3-37"><strong>15.2.2.&#160; 在线c段 webscan.cc</strong>
</p>
<p>webscan.cc</p>
<p><a href="https://c.webscan.cc/">https://c.webscan.cc/</a>
</p>
<p><img src="https://image.3001.net/images/20220726/1658830166_62dfbd56192f4c05be8aa.gif!small?1658830166802" alt="1658830166_62dfbd56192f4c05be8aa.gif!small?1658830166802" data-pswp-uid="30" /></p>
<p>c段利用脚本</p>
<pre>pip install requests

#coding:utf-8

import requests

import json

def get_c(ip):

print("正在收集{}".format(ip))

url="http://api.webscan.cc/?action=query&amp;ip={}".format(ip)

req=requests.get(url=url)

html=req.text

data=req.json()

if 'null' not in html:

with open("resulit.txt", 'a', encoding='utf-8') as f:

f.write(ip + '\n')

f.close()

for i in data:

with open("resulit.txt", 'a',encoding='utf-8') as f:

f.write("\t{} {}\n".format(i['domain'],i['title']))

print("&#160;&#160;&#160;&#160; [+] {} {}[+]".format(i['domain'],i['title']))

f.close()

def get_ips(ip):

iplist=[]

ips_str = ip[:ip.rfind('.')]

for ips in range(1, 256):

ipadd=ips_str + '.' + str(ips)

iplist.append(ipadd)

return iplist

ip=input("请你输入要查询的ip:")

ips=get_ips(ip)

for p in ips:

get_c(p)</pre>
<p id="h3-38"><strong>15.2.3.&#160; Nmap,Msscan扫描等</strong>
</p>
<p>例如：nmap -p 80,443,8000,8080 -Pn 192.168.0.0/24</p>
<p id="h3-39"><strong>15.2.4.&#160; &#160;常见端口表</strong>
</p>
<p>21,22,23,80-90,161,389,443,445,873,1099,1433,1521,1900,2082,2083,2222,2601,2604,3128,3306,3311,3312,3389,4440,4848,5432,5560,5900,5901,5902,6082,6379,7001-7010,7778,8080-8090,8649,8888,9000,9200,10000,11211,27017,28017,50000,50030,50060,135,139,445,53,88</p>
<p>注意：探测C段时一定要确认ip是否归属于目标，因为一个C段中的所有ip不一定全部属于目标。</p>
<h1>16.&#160;&#160;&#160;&#160;&#160;&#160;&#160; 网络空间搜索引擎</h1>
<p>如果想要在短时间内快速收集资产，那么利用网络空间搜索引擎是不错的选择，可以直观地看到旁站，端口，站点标题，IP等信息，点击列举出站点可以直接访问，以此来判断是否为自己需要的站点信息。FOFA的常用语法</p>
<p>1、同IP旁站：ip="192.168.0.1"</p>
<p>2、C段：ip="192.168.0.0/24"</p>
<p>3、子域名：domain="baidu.com"</p>
<p>4、标题/关键字：title="百度"</p>
<p>5、如果需要将结果缩小到某个城市的范围，那么可以拼接语句</p>
<p>title="百度"&amp;&amp; region="Beijing"</p>
<ul><li>特征：body="百度"或header="baidu"</li>
</ul>
<h1>17.&#160;&#160;&#160;&#160;&#160;&#160;&#160; 扫描敏感目录/文件</h1>
<p>扫描敏感目录需要强大的字典，需要平时积累，拥有强大的字典能够更高效地找出网站的管理后台，敏感文件常见的如.git文件泄露，.svn文件泄露，phpinfo泄露等，这一步一半交给各类扫描器就可以了，将目标站点输入到域名中，选择对应字典类型，就可以开始扫描了，十分方便。</p>
<h3>17.1. 御剑</h3>
<p>https://www.fujieace.com/hacker/tools/yujian.html</p>
<h3>17.2. 7kbstorm</h3>
<p>https://github.com/7kbstorm/7kbscan-WebPathBrute</p>
<p><img src="https://image.3001.net/images/20220726/1658830181_62dfbd65e529bf63d2138.gif!small?1658830182354" alt="1658830181_62dfbd65e529bf63d2138.gif!small?1658830182354" data-pswp-uid="31" /></p>
<h3>17.3. bbscan</h3>
<p>https://github.com/lijiejie/BBScan</p>
<p>在pip已经安装的前提下，可以直接：</p>
<pre>pip install -r requirements.txt</pre>
<p>使用示例：</p>
<ol><li>扫描单个web服务 www.target.com</li>
</ol>
<p>python BBScan.py&#160; --host <a href="http://www.target.com">www.target.com</a>
</p>
<ol><li>扫描www.target.com和www.target.com/28下的其他主机</li>
</ol>
<p>python BBScan.py&#160; --host www.target.com --network 28</p>
<ol><li>扫描txt文件中的所有主机</li>
</ol>
<p>python BBScan.py -f wandoujia.com.txt</p>
<ol><li>从文件夹中导入所有的主机并扫描</li>
</ol>
<p>python BBScan.py -d targets/</p>
<p>–network 参数用于设置子网掩码，小公司设为28~30，中等规模公司设置26~28，大公司设为24~26</p>
<p>当然，尽量避免设为24，扫描过于耗时，除非是想在各SRC多刷几个漏洞。</p>
<p>该插件是从内部扫描器中抽离出来的，感谢 Jekkay Hu&lt;34538980[at]qq.com&gt;</p>
<p>如果你有非常有用的规则，请找几个网站验证测试后，再 pull request</p>
<p>脚本还会优化，接下来的事:</p>
<p>增加有用规则，将规则更好地分类，细化</p>
<p>后续可以直接从 rules\request 文件夹中导入HTTP_request</p>
<p>优化扫描逻辑</p>
<h3>17.4. dirmap</h3>
<pre>pip install -r requirement.txt
https://github.com/H4ckForJob/dirmap</pre>
<p>单个目标</p>
<pre>python3 dirmap.py -i https://target.com -lcf</pre>
<p>多个目标</p>
<pre>python3 dirmap.py -iF urls.txt -lcf</pre>
<h3 id="h3-40">17.5. dirsearch</h3>
<p>https://gitee.com/Abaomianguan/dirsearch.git</p>
<p>unzip dirsearch.zip</p>
<p>python3 dirsearch.py -u http://m.scabjd.com/ -e *</p>
<p><img src="https://image.3001.net/images/20220726/1658830197_62dfbd758381c19095ba7.gif!small?1658830198074" alt="1658830197_62dfbd758381c19095ba7.gif!small?1658830198074" data-pswp-uid="32" /></p>
<h3 id="h3-41">17.6. gobuster</h3>
<pre>sudo apt-get install gobuster
gobuster dir -u https://www.servyou.com.cn/ -w /usr/share/wordlists/dirbuster/directory-list-2.3-medium.txt -x php -t 50</pre>
<p>dir -u 网址 w字典 -x 指定后缀 -t 线程数量</p>
<pre>dir -u https://www.servyou.com.cn/ -w /usr/share/wordlists/dirbuster/directory-list-2.3-medium.txt -x "php,html,rar,zip" -d --wildcard -o servyou.log | grep ^"3402"</pre>
<h3 id="h3-42">17.7. 网站文件</h3>
<blockquote><p>robots.txt</p>
<p>crossdomin.xml</p>
<p>sitemap.xml</p>
<p>后台目录</p>
<p>网站安装包</p>
<p>网站上传目录</p>
<p>mysql管理页面</p>
<p>phpinfo</p>
<p>网站文本编辑器</p>
<p>测试文件</p>
<p>网站备份文件(.rar、zip、.7z、.tar.gz、.bak)</p>
<p>DS_Store 文件</p>
<p>vim编辑器备份文件(.swp)</p>
<p>WEB—INF/web.xml文件</p>
<p>15 .git</p>
<p>16 .svn</p>
</blockquote>
<p><a href="https://www.secpulse.com/archives/55286.html">https://www.secpulse.com/archives/55286.html</a>
</p>
<h1>18.&#160;&#160;&#160;&#160;&#160;&#160;&#160; 扫描网页备份</h1>
<p>例如</p>
<p>config.php</p>
<p>config.php~</p>
<p>config.php.bak</p>
<p>config.php.swp</p>
<p>config.php.rar</p>
<p>conig.php.tar.gz</p>
<h1>19.&#160;&#160;&#160;&#160;&#160;&#160;&#160; 网站头信息收集</h1>
<p><img src="https://image.3001.net/images/20220726/1658830212_62dfbd84b3060126837a5.gif!small?1658830213192" alt="1658830212_62dfbd84b3060126837a5.gif!small?1658830213192" data-pswp-uid="33" /></p>
<p>1、中间件 ：web服务【Web Servers】 apache iis7 iis7.5 iis8 nginx WebLogic tomcat</p>
<p>2.、网站组件： js组件jquery、vue&#160; 页面的布局bootstrap</p>
<p>通过浏览器获取</p>
<p>http://whatweb.bugscaner.com/look/</p>
<p><img src="https://image.3001.net/images/20220726/1658830231_62dfbd97dd47c624bd856.gif!small?1658830232454" alt="1658830231_62dfbd97dd47c624bd856.gif!small?1658830232454" data-pswp-uid="34" /></p>
<p>火狐的插件Wappalyzer</p>
<p><img src="https://image.3001.net/images/20220726/1658830238_62dfbd9ef0961bc56520c.gif!small?1658830239612" alt="1658830238_62dfbd9ef0961bc56520c.gif!small?1658830239612" data-pswp-uid="35" /></p>
<p>curl命令查询头信息</p>
<p>curl https://www.baidu.com -i</p>
<p><img src="https://image.3001.net/images/20220726/1658830253_62dfbdadc7feaa5e31e0a.gif!small?1658830254347" alt="1658830253_62dfbdadc7feaa5e31e0a.gif!small?1658830254347" data-pswp-uid="36" /></p>
<h1>20.&#160;&#160;&#160;&#160;&#160;&#160;&#160; 敏感文件搜索</h1>
<h3 id="h3-43">20.1. GitHub搜索</h3>
<p>in:name test #仓库标题搜索含有关键字test</p>
<p>in:descripton test #仓库描述搜索含有关键字</p>
<p>in:readme test #Readme文件搜素含有关键字</p>
<p>搜索某些系统的密码</p>
<p><a href="https://github.com/search?q=smtp+58.com+password+3306&amp;type=Code">https://github.com/search?q=smtp+58.com+password+3306&amp;type=Code</a>
</p>
<p>github 关键词监控</p>
<p><a href="https://www.codercto.com/a/46640.html">https://www.codercto.com/a/46640.html</a>
</p>
<p>谷歌搜索</p>
<p>site:Github.com sa password</p>
<p>site:Github.com root password</p>
<p>site:Github.com User ID='sa';Password</p>
<p>site:Github.com inurl:sql</p>
<p>SVN 信息收集</p>
<p>site:Github.com svn</p>
<p>site:Github.com svn username</p>
<p>site:Github.com svn password</p>
<p>site:Github.com svn username password</p>
<p>综合信息收集</p>
<p>site:Github.com password</p>
<p>site:Github.com ftp ftppassword</p>
<p>site:Github.com 密码</p>
<p>site:Github.com 内部</p>
<p>https://blog.csdn.net/qq_36119192/article/details/99690742</p>
<p>http://www.361way.com/github-hack/6284.html</p>
<p><a href="https://docs.github.com/cn/github/searching-for-information-on-github/searching-code">https://docs.github.com/cn/github/searching-for-information-on-github/searching-code</a>
</p>
<p>https://github.com/search?q=smtp+bilibili.com&amp;type=code</p>
<h3 id="h3-44">20.2. Google-hacking</h3>
<p>site:域名</p>
<p>inurl: url中存在的关键字网页</p>
<p>intext：网页正文中的关键词</p>
<p>filetype:指定文件类型</p>
<h3 id="h3-45">20.3. wooyun漏洞库</h3>
<p><a href="https://wooyun.website/">https://wooyun.website/</a>
</p>
<h3 id="h3-46">20.4. 网盘搜索</h3>
<p>凌云搜索&#160; <a href="https://www.lingfengyun.com/">https://www.lingfengyun.com/</a>
</p>
<p>盘多多：http://www.panduoduo.net/</p>
<p>盘搜搜：http://www.pansoso.com/</p>
<p>盘搜：http://www.pansou.com/</p>
<h3 id="h3-47">20.5. 社工库</h3>
<p>名字/常用id/邮箱/密码/电话 登录 网盘 网站 邮箱 找敏感信息</p>
<p>tg机器人</p>
<p><img src="https://image.3001.net/images/20220726/1658830269_62dfbdbd241fb09b48016.gif!small?1658830269836" alt="1658830269_62dfbdbd241fb09b48016.gif!small?1658830269836" data-pswp-uid="37" /></p>
<h3 id="h3-48">20.6. 网站注册信息</h3>
<p><a href="http://www.reg007.com">www.reg007.com</a>查询网站注册信息</p>
<p>一般是配合社工库一起来使用。</p>
<p><img src="https://image.3001.net/images/20220726/1658830365_62dfbe1de75b3772b6354.jpg!small?1658830366433" alt="1658830365_62dfbe1de75b3772b6354.jpg!small?1658830366433" data-pswp-uid="38" /></p>
<h3 id="h3-49">20.7. js敏感信息</h3>
<ul><li>网站的url连接写到js里面</li>
<li>js的api接口 里面包含用户信息 比如 账号和密码</li>
</ul>
<p><strong>20.7.1.&#160; jsfinder</strong>
</p>
<p>https://gitee.com/kn1fes/JSFinder</p>
<p>python3 JSFinder.py -u <a href="http://www.mi.com">http://www.mi.com</a>
</p>
<p>python3 JSFinder.py -u http://www.mi.com -d</p>
<p>python3 JSFinder.py -u http://www.mi.com -d -ou mi_url.txt -os mi_subdomain.txt</p>
<p>当你想获取更多信息的时候，可以使用-d进行深度爬取来获得更多内容，并使用命令 -ou, -os来指定URL和子域名所保存的文件名</p>
<p>批量指定URL和JS链接来获取里面的URL。</p>
<p>指定URL：</p>
<p>python JSFinder.py -f text.txt</p>
<p>指定JS：</p>
<p>python JSFinder.py -f text.txt -j</p>
<p><strong>20.7.2.&#160; Packer-Fuzzer</strong>
</p>
<p>寻找网站交互接口 授权key</p>
<p>随着WEB前端打包工具的流行，您在日常渗透测试、安全服务中是否遇到越来越多以Webpack打包器为代表的网站？这类打包器会将整站的API和API参数打包在一起供Web集中调用，这也便于我们快速发现网站的功能和API清单，但往往这些打包器所生成的JS文件数量异常之多并且总JS代码量异常庞大（多达上万行），这给我们的手工测试带来了极大的不便，Packer Fuzzer软件应运而生。</p>
<p>本工具支持自动模糊提取对应目标站点的API以及API对应的参数内容，并支持对：未授权访问、敏感信息泄露、CORS、SQL注入、水平越权、弱口令、任意文件上传七大漏洞进行模糊高效的快速检测。在扫描结束之后，本工具还支持自动生成扫描报告，您可以选择便于分析的HTML版本以及较为正规的doc、pdf、txt版本。</p>
<p>sudo apt-get install nodejs &amp;&amp; sudo apt-get install npm</p>
<p>git clone <a href="https://gitee.com/keyboxdzd/Packer-Fuzzer.git">https://gitee.com/keyboxdzd/Packer-Fuzzer.git</a>
</p>
<p>pip3 install -r requirements.txt</p>
<p>python3 PackerFuzzer.py -u https://www.liaoxuefeng.com</p>
<p><img src="https://image.3001.net/images/20220726/1658830389_62dfbe35d2aea6f6e54eb.gif!small?1658830390474" alt="1658830389_62dfbe35d2aea6f6e54eb.gif!small?1658830390474" data-pswp-uid="39" /></p>
<p><img src="https://image.3001.net/images/20220726/1658830404_62dfbe4455852e786e99f.gif!small?1658830404786" alt="1658830404_62dfbe4455852e786e99f.gif!small?1658830404786" data-pswp-uid="40" /></p>
<p><strong>20.7.3.&#160; SecretFinder</strong>
</p>
<p>一款基于Python脚本的JavaScript敏感信息搜索工具</p>
<p>https://gitee.com/mucn/SecretFinder</p>
<p>python3 SecretFinder.py -i https://www.baidu.com/ -e</p>
<h1>21.&#160;&#160;&#160;&#160;&#160;&#160;&#160; cms识别</h1>
<p>收集好网站信息之后，应该对网站进行指纹识别，通过识别指纹，确定目标的cms及版本，方便制定下一步的测试计划，可以用公开的poc或自己累积的对应手法等进行正式的渗透测试。</p>
<h3 id="h3-50">21.1. 云悉</h3>
<p>http://www.yunsee.cn/info.html</p>
<h3 id="h3-51">21.2. 潮汐指纹</h3>
<p>http://finger.tidesec.net/</p>
<h3 id="h3-52">21.3. CMS指纹识别</h3>
<p><a href="http://whatweb.bugscaner.com/look/">http://whatweb.bugscaner.com/look/</a>
</p>
<p>https://github.com/search?q=cms识别</p>
<h3 id="h3-53">21.4. whatcms</h3>
<p><img src="https://image.3001.net/images/20220726/1658830435_62dfbe63b52fc56cf7764.gif!small?1658830436157" alt="1658830435_62dfbe63b52fc56cf7764.gif!small?1658830436157" data-pswp-uid="41" /></p>
<h3 id="h3-54">21.5. 御剑cms识别</h3>
<p><a href="https://github.com/ldbfpiaoran/cmscan">https://github.com/ldbfpiaoran/cmscan</a>
</p>
<p>https://github.com/theLSA/cmsIdentification/</p>
<h1>22.&#160;&#160;&#160;&#160;&#160;&#160;&#160; 非常规操作</h1>
<p>1、如果找到了目标的一处资产，但是对目标其他资产的收集无处下手时，可以查看一下该站点的body里是否有目标的特征，然后利用网络空间搜索引擎（如fofa等）对该特征进行搜索，如：body=”XX公司”或body=”baidu”等。</p>
<p>该方式一般适用于特征明显，资产数量较多的目标，并且很多时候效果拔群。</p>
<p>2、当通过上述方式的找到test.com的特征后，再进行body的搜索，然后再搜索到test.com的时候，此时fofa上显示的ip大概率为test.com的真实IP。</p>
<p>3、如果需要对政府网站作为目标，那么在批量获取网站首页的时候，可以用上</p>
<p>http://114.55.181.28/databaseInfo/index</p>
<p>之后可以结合上一步的方法进行进一步的信息收集。</p>
<h1>23.&#160;&#160;&#160;&#160;&#160;&#160;&#160; SSL/TLS证书查询</h1>
<p>SSL/TLS证书通常包含域名、子域名和邮件地址等信息，结合证书中的信息，可以更快速地定位到目标资产，获取到更多目标资产的相关信息。</p>
<p>https://myssl.com/</p>
<p><a href="https://crt.sh">https://crt.sh</a>
</p>
<p><a href="https://censys.io">https://censys.io</a>
</p>
<p>https://developers.facebook.com/tools/ct/</p>
<p>https://google.com/transparencyreport/https/ct/</p>
<p>SSL证书搜索引擎：</p>
<p>https://certdb.com/domain/github.com</p>
<p><a href="https://crt.sh/?Identity=%25.moonsec.com">https://crt.sh/?Identity=%.baidu.com</a>
</p>
<p><a href="https://censys.io/">https://censys.io/</a>
</p>
<p>GetDomainsBySSL.py<img src="https://image.3001.net/images/20220726/1658830453_62dfbe75795a22329e72c.gif!small?1658830454028" alt="1658830453_62dfbe75795a22329e72c.gif!small?1658830454028" data-pswp-uid="42" /></p>
<h1>24.&#160;&#160;&#160;&#160;&#160;&#160;&#160; 查找厂商ip段</h1>
<p><a href="http://ipwhois.cnnic.net.cn/index.jsp">http://ipwhois.cnnic.net.cn/index.jsp</a>
</p>
<h1>25.&#160;&#160;&#160;&#160;&#160;&#160;&#160; 移动资产收集</h1>
<h3 id="h3-55">25.1. 微信小程序支付宝小程序</h3>
<p>现在很多企业都有小程序，可以关注企业的微信公众号或者支付宝小程序，或关注运营相关人员，查看朋友圈，获取小程序。</p>
<p><a href="https://weixin.sogou.com/weixin?type=1&amp;ie=utf8&amp;query=%E6%8B%BC%E5%A4%9A%E5%A4%9A">https://weixin.sogou.com/weixin?type=1&amp;ie=utf8&amp;query=%E6%8B%BC%E5%A4%9A%E5%A4%9A<img src="https://image.3001.net/images/20220726/1658830464_62dfbe80ede39de669d59.gif!small?1658830465472" alt="1658830464_62dfbe80ede39de669d59.gif!small?1658830465472" data-pswp-uid="43" /><img src="https://image.3001.net/images/20220726/1658830478_62dfbe8e824de402e007e.jpg!small?1658830479082" alt="1658830478_62dfbe8e824de402e007e.jpg!small?1658830479082" data-pswp-uid="44" /></a>
</p>
<h3 id="h3-56">25.2. app软件搜索</h3>
<p><a href="https://www.qimai.cn/">https://www.qimai.cn/</a>
</p>
<p><img src="https://image.3001.net/images/20220726/1658830490_62dfbe9aa29af9fd12cdc.gif!small?1658830491094" alt="1658830490_62dfbe9aa29af9fd12cdc.gif!small?1658830491094" data-pswp-uid="45" /></p>
<h1>26.&#160;&#160;&#160;&#160;&#160;&#160;&#160; 社交信息搜索</h1>
<p>QQ群 QQ手机号</p>
<p>微信群</p>
<p>领英</p>
<p><a href="https://www.linkedin.com/">https://www.linkedin.com/</a>
</p>
<p>脉脉招聘</p>
<p>boss招聘</p>
<h1>27.&#160;&#160;&#160;&#160;&#160;&#160;&#160; js敏感文件</h1>
<p><a href="https://github.com/m4ll0k/SecretFinder">https://github.com/m4ll0k/SecretFinder</a>
</p>
<p>https://github.com/Threezh1/JSFinder</p>
<p><a href="https://github.com/rtcatc/Packer-Fuzzer">https://github.com/rtcatc/Packer-Fuzzer</a>
</p>
<h1>28.&#160;&#160;&#160;&#160;&#160;&#160;&#160; github信息泄露监控</h1>
<p>https://github.com/0xbug/Hawkeye</p>
<p>https://github.com/MiSecurity/x-patrol</p>
<p><a href="https://github.com/VKSRC/Github-Monitor">https://github.com/VKSRC/Github-Monitor</a>
</p>
<h1>29.&#160;&#160;&#160;&#160;&#160;&#160;&#160; 防护软件收集</h1>
<p>安全防护 云waf、硬件waf、主机防护软件、软waf</p>
<h1>30.&#160;&#160;&#160;&#160;&#160;&#160;&#160; 社工相关</h1>
<p>微信或者QQ 混入内部群，蹲点观测。加客服小姐姐发一些连接。进一步获取敏感信息。测试产品，购买服务器，拿去测试账号和密码。</p>
<h1>31.&#160;&#160;&#160;&#160;&#160;&#160;&#160; 物理接触</h1>
<p>到企业办公层连接wifi，连同内网。丢一些带有后门的usb 开放免费的wifi截取账号和密码。</p>
<h1>32.&#160;&#160;&#160;&#160;&#160;&#160;&#160; 社工库</h1>
<p>在tg找社工机器人 查找密码信息&#160; 或本地的社工库查找邮箱或者用户的密码或密文。组合密码在进行猜解登录。</p>
<h1>33.&#160;&#160;&#160;&#160;&#160;&#160;&#160; 资产收集神器</h1>
<p>ARL(Asset Reconnaissance Lighthouse)资产侦察灯塔系统</p>
<p><a href="https://github.com/TophantTechnology/ARL">https://github.com/TophantTechnology/ARL</a>
</p>
<p>AssetsHunter</p>
<p><a href="https://github.com/rabbitmask/AssetsHunter">https://github.com/rabbitmask/AssetsHunter</a>
</p>
<p>一款用于src资产信息收集的工具</p>
<p><a href="https://github.com/sp4rkw/Reaper">https://github.com/sp4rkw/Reaper</a>
</p>
<p>domain_hunter_pro</p>
<p><a href="https://github.com/bit4woo/domain_hunter_pro">https://github.com/bit4woo/domain_hunter_pro</a>
</p>
<p>LangSrcCurise</p>
<p>https://github.com/shellsec/LangSrcCurise</p>
<p>网段资产</p>
<p>https://github.com/colodoo/midscan</p>
<h1>34.&#160;&#160;&#160;&#160;&#160;&#160;&#160; 工具</h1>
<p>Fuzz字典推荐：https://github.com/TheKingOfDuck/fuzzDicts</p>
<p>BurpCollector(BurpSuite参数收集插件)：https://github.com/TEag1e/BurpCollector</p>
<p>Wfuzz：https://github.com/xmendez/wfuzz</p>
<p>LinkFinder：https://github.com/GerbenJavado/LinkFinder</p>
<p>PoCBox：<a href="https://github.com/Acmesec/PoCBox">https://github.com/Acmesec/PoCBox</a>
</p>
<h1>35.&#160;&#160;&#160;&#160;&#160;&#160;&#160; 信息收集思维导图</h1>
<p>最后献上一张思维导图<img src="https://image.3001.net/images/20220726/1658830540_62dfbecc78835e44c3a95.jpg!small?1658830541704" alt="1658830540_62dfbecc78835e44c3a95.jpg!small?1658830541704" data-pswp-uid="46" /></p>
<p>如有不足的地方还请各位大佬补充</p>
</div>
</div>
